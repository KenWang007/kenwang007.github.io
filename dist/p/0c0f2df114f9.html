<!DOCTYPE html>
<html lang="zh-CN" class="page-article">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜ - å…³é”®è¯: Redis, Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜, å¦‚ä½•ä½¿ç”¨">
    <meta name="keywords" content="Redis, Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜, å¦‚ä½•ä½¿ç”¨, è§£å†³åˆ†å¸ƒå¼ç¼“å­˜">
    <meta name="author" content="Ken Wang">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://kenwang007.github.io/dist/p/0c0f2df114f9.html">
    <meta property="og:title" content="å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜ - Kençš„çŸ¥è¯†åº“">
    <meta property="og:description" content="å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜ - å…³é”®è¯: Redis, Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜, å¦‚ä½•ä½¿ç”¨">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary">
    <meta property="twitter:url" content="https://kenwang007.github.io/dist/p/0c0f2df114f9.html">
    <meta property="twitter:title" content="å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜ - Kençš„çŸ¥è¯†åº“">
    <meta property="twitter:description" content="å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜ - å…³é”®è¯: Redis, Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜, å¦‚ä½•ä½¿ç”¨">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#6366f1">
    
    <title>å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜ - Kençš„çŸ¥è¯†åº“</title>
    <link rel="stylesheet" href="/style.css?v=2.1.2">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%236366f1%22>ğŸ“š</text></svg>">
    <link rel="canonical" href="https://kenwang007.github.io/dist/p/0c0f2df114f9.html">
    <link rel="manifest" href="/manifest.json">
    
    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- RSS Feed -->
    <link rel="alternate" type="application/rss+xml" title="Kençš„çŸ¥è¯†åº“ RSS Feed" href="/rss.xml">
    
    <!-- Breadcrumb Navigation -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "é¦–é¡µ",
          "item": "https://kenwang007.github.io/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜",
          "item": "https://kenwang007.github.io/dist/p/0c0f2df114f9.html"
        }
      ]
    }
    </script>
    
    <!-- Article Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": "å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜",
      "description": "å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜ - å…³é”®è¯: Redis, Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜, å¦‚ä½•ä½¿ç”¨",
      "author": {
        "@type": "Person",
        "name": "Ken Wang"
      },
      "datePublished": "2026-01-31T11:08:30.291379",
      "dateModified": "2026-01-31T11:08:30.291379",
      "inLanguage": "zh-CN"
    }
    </script>
</head>
<body>
    <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
    <div class="stars"></div>
    <div class="stars2"></div>
    <div class="stars3"></div>

    <!-- é¡¶éƒ¨å›ºå®šå¯¼èˆª -->
    <header class="top-nav">
        <div class="nav-container">
            <div class="logo">
                <a href="/index.html">
                    <span class="logo-text">ğŸ“š Kençš„çŸ¥è¯†åº“</span>
                </a>
            </div>
            <nav class="main-nav">
                <ul id="nav-menu" class="nav-menu">
                    <!-- åŠ¨æ€ç”Ÿæˆçš„å¯¼èˆªèœå•é¡¹ -->
                </ul>
            </nav>
        </div>
    </header>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <main class="main-content">
        <!-- å·¦ä¾§å›ºå®šå…³é”®è¯ç´¢å¼• -->
        <aside class="keyword-sidebar">
            <div class="keyword-header">
                <h3>å…³é”®è¯ç´¢å¼•</h3>
            </div>
            <div class="keyword-list" id="keyword-list">
                <!-- åŠ¨æ€ç”Ÿæˆçš„å…³é”®è¯ -->
            </div>
        </aside>

        <!-- ä¸­é—´ä¸»å†…å®¹ -->
        <section class="content-area">
            <div class="content-wrapper">
                <article class="markdown-content">
                    
<h1 id="å¦‚ä½•ä½¿ç”¨redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜">å¦‚ä½•ä½¿ç”¨Redisè§£å†³åˆ†å¸ƒå¼ç¼“å­˜</h1>
<p>åœ¨ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­ï¼Œç¼“å­˜æŠ€æœ¯å·²æˆä¸ºæå‡ç³»ç»Ÿæ€§èƒ½ã€é™ä½æ•°æ®åº“è´Ÿè½½çš„å…³é”®æ‰‹æ®µã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨åˆ†å¸ƒå¼ç¼“å­˜çš„å¿…è¦æ€§ã€ä¸šç•Œä¸»æµè§£å†³æ–¹æ¡ˆï¼Œä»¥åŠå¦‚ä½•åœ¨.NETæŠ€æœ¯æ ˆä¸­åŸºäºMicrosoftå®˜æ–¹æ¨èçš„æœ€ä½³å®è·µæ¥å®ç°Redisåˆ†å¸ƒå¼ç¼“å­˜ã€‚</p>
<h2 id="ä¸€åˆ†å¸ƒå¼ç¼“å­˜çš„å¿…è¦æ€§åˆ†æ">ä¸€ã€åˆ†å¸ƒå¼ç¼“å­˜çš„å¿…è¦æ€§åˆ†æ</h2>
<h3 id="åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„çš„æŠ€æœ¯èƒŒæ™¯">1.1 åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„çš„æŠ€æœ¯èƒŒæ™¯</h3>
<p>éšç€äº‘è®¡ç®—å’Œå¾®æœåŠ¡æ¶æ„çš„æ™®åŠï¼Œç°ä»£åº”ç”¨ç¨‹åºé€šå¸¸éƒ¨ç½²åœ¨å¤šå°æœåŠ¡å™¨ä¸Šï¼Œå½¢æˆåˆ†å¸ƒå¼ç³»ç»Ÿã€‚åœ¨è¿™ç§æ¶æ„ä¸‹ï¼Œä¼ ç»Ÿçš„æœ¬åœ°ç¼“å­˜ï¼ˆå¦‚å†…å­˜ç¼“å­˜ï¼‰é¢ä¸´ç€ä¸¥å³»çš„æŒ‘æˆ˜ï¼š</p>
<p><strong>å•æœºç¼“å­˜çš„å±€é™æ€§</strong>ï¼š -
<strong>æ•°æ®å­¤å²›é—®é¢˜</strong>ï¼šæ¯å°æœåŠ¡å™¨çš„ç¼“å­˜ç‹¬ç«‹å­˜åœ¨ï¼Œæ— æ³•å…±äº«æ•°æ® -
<strong>æ•°æ®ä¸€è‡´æ€§æŒ‘æˆ˜</strong>ï¼šä¸åŒæœåŠ¡å™¨ä¸Šçš„ç¼“å­˜æ•°æ®å¯èƒ½ä¸ä¸€è‡´ -
<strong>èµ„æºæµªè´¹</strong>ï¼šç›¸åŒçš„æ•°æ®åœ¨å¤šå°æœåŠ¡å™¨ä¸Šé‡å¤ç¼“å­˜ -
<strong>æ‰©å±•æ€§å—é™</strong>ï¼šæ— æ³•åŠ¨æ€æ‰©å±•ç¼“å­˜å®¹é‡</p>
<p>æ ¹æ®Microsoftå®˜æ–¹æ–‡æ¡£ï¼Œå½“åº”ç”¨æ‰˜ç®¡åœ¨äº‘æˆ–æœåŠ¡å™¨åœºä¸­æ—¶ï¼Œéœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜æ¥å­˜å‚¨æ•°æ®ï¼Œä»¥ç¡®ä¿æ‰€æœ‰åº”ç”¨å®ä¾‹éƒ½èƒ½è®¿é—®ç›¸åŒçš„ç¼“å­˜æ•°æ®ã€‚</p>
<h3 id="åˆ†å¸ƒå¼ç¼“å­˜è§£å†³çš„å…³é”®é—®é¢˜">1.2 åˆ†å¸ƒå¼ç¼“å­˜è§£å†³çš„å…³é”®é—®é¢˜</h3>
<h4 id="æ•°æ®åº“è´Ÿè½½è¿‡é«˜">1.2.1 æ•°æ®åº“è´Ÿè½½è¿‡é«˜</h4>
<p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¤§é‡è¯·æ±‚ç›´æ¥è®¿é—®æ•°æ®åº“ä¼šå¯¼è‡´æ•°æ®åº“è´Ÿè½½è¿‡é«˜ï¼Œç”šè‡³å¼•å‘æ•°æ®åº“å´©æºƒã€‚åˆ†å¸ƒå¼ç¼“å­˜é€šè¿‡åœ¨å†…å­˜ä¸­å­˜å‚¨çƒ­ç‚¹æ•°æ®ï¼Œå¤§å¹…å‡å°‘å¯¹æ•°æ®åº“çš„ç›´æ¥è®¿é—®ã€‚</p>
<p><strong>æŠ€æœ¯åŸç†</strong>ï¼š -
ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼šå°†é¢‘ç¹è®¿é—®çš„æ•°æ®å­˜å‚¨åœ¨åˆ†å¸ƒå¼ç¼“å­˜ä¸­ -
å‡å°‘æ•°æ®åº“æŸ¥è¯¢ï¼šå¤§å¤šæ•°è¯·æ±‚ä»ç¼“å­˜è·å–æ•°æ®ï¼Œé¿å…æ•°æ®åº“æŸ¥è¯¢ -
é™ä½æ•°æ®åº“å‹åŠ›ï¼šå‡å°‘æ•°æ®åº“è¿æ¥æ•°ã€æŸ¥è¯¢æ¬¡æ•°å’ŒCPUä½¿ç”¨ç‡</p>
<h4 id="ç³»ç»Ÿå“åº”å»¶è¿Ÿ">1.2.2 ç³»ç»Ÿå“åº”å»¶è¿Ÿ</h4>
<p>æ•°æ®åº“æŸ¥è¯¢é€šå¸¸æ¶‰åŠç£ç›˜I/Oæ“ä½œï¼Œå“åº”æ—¶é—´è¾ƒé•¿ï¼ˆé€šå¸¸åœ¨å‡ åæ¯«ç§’åˆ°å‡ ç™¾æ¯«ç§’ï¼‰ã€‚è€Œåˆ†å¸ƒå¼ç¼“å­˜åŸºäºå†…å­˜å­˜å‚¨ï¼Œå“åº”æ—¶é—´é€šå¸¸åœ¨å¾®ç§’çº§åˆ«ã€‚</p>
<p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š - æ•°æ®åº“æŸ¥è¯¢ï¼š50-500ms -
åˆ†å¸ƒå¼ç¼“å­˜æŸ¥è¯¢ï¼š1-10ms - æ€§èƒ½æå‡ï¼š5-500å€</p>
<h4 id="æ•°æ®ä¸€è‡´æ€§æŒ‘æˆ˜">1.2.3 æ•°æ®ä¸€è‡´æ€§æŒ‘æˆ˜</h4>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šå°æœåŠ¡å™¨éœ€è¦ä¿æŒæ•°æ®ä¸€è‡´æ€§ã€‚æœ¬åœ°ç¼“å­˜æ— æ³•å®ç°è·¨æœåŠ¡å™¨çš„æ•°æ®å…±äº«ï¼Œè€Œåˆ†å¸ƒå¼ç¼“å­˜æä¾›äº†ç»Ÿä¸€çš„æ•°æ®å­˜å‚¨å±‚ã€‚</p>
<p><strong>ä¸€è‡´æ€§ä¿è¯</strong>ï¼š - æ‰€æœ‰æœåŠ¡å™¨è®¿é—®åŒä¸€ç¼“å­˜å®ä¾‹ -
æ•°æ®æ›´æ–°åï¼Œæ‰€æœ‰æœåŠ¡å™¨ç«‹å³è·å–æœ€æ–°æ•°æ® -
é¿å…å› ç¼“å­˜ä¸ä¸€è‡´å¯¼è‡´çš„ä¸šåŠ¡é”™è¯¯</p>
<h3 id="åˆ†å¸ƒå¼ç¼“å­˜ç›¸æ¯”æœ¬åœ°ç¼“å­˜çš„æ ¸å¿ƒä¼˜åŠ¿">1.3
åˆ†å¸ƒå¼ç¼“å­˜ç›¸æ¯”æœ¬åœ°ç¼“å­˜çš„æ ¸å¿ƒä¼˜åŠ¿</h3>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>æœ¬åœ°ç¼“å­˜</th>
<th>åˆ†å¸ƒå¼ç¼“å­˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æ•°æ®å…±äº«</strong></td>
<td>ä»…é™å•æœº</td>
<td>è·¨æœåŠ¡å™¨å…±äº«</td>
</tr>
<tr>
<td><strong>ä¸€è‡´æ€§</strong></td>
<td>å„æœåŠ¡å™¨ç‹¬ç«‹</td>
<td>å…¨å±€ä¸€è‡´</td>
</tr>
<tr>
<td><strong>å®¹é‡</strong></td>
<td>å—é™äºå•æœºå†…å­˜</td>
<td>å¯æ¨ªå‘æ‰©å±•</td>
</tr>
<tr>
<td><strong>å¯ç”¨æ€§</strong></td>
<td>å•æœºæ•…éšœå³å¤±æ•ˆ</td>
<td>é«˜å¯ç”¨é›†ç¾¤</td>
</tr>
<tr>
<td><strong>é€‚ç”¨åœºæ™¯</strong></td>
<td>å•æœºåº”ç”¨</td>
<td>åˆ†å¸ƒå¼ç³»ç»Ÿ</td>
</tr>
</tbody>
</table>
<p>æ ¹æ®Microsoftå®˜æ–¹æ–‡æ¡£ï¼Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºï¼š -
<strong>è·¨å®ä¾‹å…±äº«</strong>ï¼šæ‰€æœ‰åº”ç”¨å®ä¾‹éƒ½èƒ½è®¿é—®ç›¸åŒçš„ç¼“å­˜æ•°æ® -
<strong>é«˜å¯ç”¨æ€§</strong>ï¼šæ”¯æŒæ•…éšœè½¬ç§»å’Œé›†ç¾¤éƒ¨ç½² -
<strong>å¯æ‰©å±•æ€§</strong>ï¼šå¯æ ¹æ®è´Ÿè½½åŠ¨æ€æ‰©å±•ç¼“å­˜å®¹é‡</p>
<h2
id="äºŒä¸šç•Œä¸»æµåˆ†å¸ƒå¼ç¼“å­˜è§£å†³æ–¹æ¡ˆæ¦‚è¿°">äºŒã€ä¸šç•Œä¸»æµåˆ†å¸ƒå¼ç¼“å­˜è§£å†³æ–¹æ¡ˆæ¦‚è¿°</h2>
<h3 id="redis">2.1 Redis</h3>
<h4 id="æ ¸å¿ƒè®¾è®¡æ€è·¯">2.1.1 æ ¸å¿ƒè®¾è®¡æ€è·¯</h4>
<p>Redisï¼ˆRemote Dictionary
Serverï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„å†…å­˜æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå¯ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä»£ç†ã€‚å…¶æ ¸å¿ƒè®¾è®¡æ€è·¯åŒ…æ‹¬ï¼š</p>
<p><strong>æ•°æ®ç»“æ„ä¸°å¯Œ</strong>ï¼š -
æ”¯æŒå¤šç§æ•°æ®ç±»å‹ï¼šå­—ç¬¦ä¸²ï¼ˆStringï¼‰ã€å“ˆå¸Œï¼ˆHashï¼‰ã€åˆ—è¡¨ï¼ˆListï¼‰ã€é›†åˆï¼ˆSetï¼‰ã€æœ‰åºé›†åˆï¼ˆSorted
Setï¼‰ -
æ”¯æŒä½å›¾ï¼ˆBitmapï¼‰ã€è¶…æ—¥å¿—ï¼ˆHyperLogLogï¼‰ã€åœ°ç†ä½ç½®ï¼ˆGeoï¼‰ç­‰é«˜çº§æ•°æ®ç»“æ„
- æ”¯æŒäº‹åŠ¡ã€Luaè„šæœ¬ã€å‘å¸ƒè®¢é˜…ç­‰é«˜çº§åŠŸèƒ½</p>
<p><strong>é«˜æ€§èƒ½è®¾è®¡</strong>ï¼š - å•çº¿ç¨‹æ¨¡å‹ï¼šé¿å…å¤šçº¿ç¨‹ç«äº‰å’Œé”å¼€é”€ -
å†…å­˜å­˜å‚¨ï¼šæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œè®¿é—®é€Ÿåº¦å¿« -
I/Oå¤šè·¯å¤ç”¨ï¼šä½¿ç”¨epollç­‰æœºåˆ¶å®ç°é«˜å¹¶å‘å¤„ç†</p>
<p><strong>æŒä¹…åŒ–æ”¯æŒ</strong>ï¼š - RDBï¼ˆRedis
Databaseï¼‰ï¼šå®šæœŸå°†æ•°æ®å¿«ç…§ä¿å­˜åˆ°ç£ç›˜ - AOFï¼ˆAppend Only
Fileï¼‰ï¼šè®°å½•æ‰€æœ‰å†™æ“ä½œï¼Œé‡å¯æ—¶é‡æ”¾ - æ··åˆæŒä¹…åŒ–ï¼šç»“åˆRDBå’ŒAOFçš„ä¼˜åŠ¿</p>
<h4 id="é€‚ç”¨åœºæ™¯">2.1.2 é€‚ç”¨åœºæ™¯</h4>
<p>Redisé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š -
<strong>ç¼“å­˜ç³»ç»Ÿ</strong>ï¼šä½œä¸ºåˆ†å¸ƒå¼ç¼“å­˜å­˜å‚¨çƒ­ç‚¹æ•°æ® -
<strong>ä¼šè¯å­˜å‚¨</strong>ï¼šå­˜å‚¨ç”¨æˆ·ä¼šè¯ä¿¡æ¯ -
<strong>æ’è¡Œæ¦œ</strong>ï¼šåˆ©ç”¨æœ‰åºé›†åˆå®ç°å®æ—¶æ’è¡Œæ¦œ -
<strong>è®¡æ•°å™¨</strong>ï¼šåˆ©ç”¨åŸå­æ“ä½œå®ç°è®¡æ•°åŠŸèƒ½ -
<strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼šåˆ©ç”¨å‘å¸ƒè®¢é˜…åŠŸèƒ½å®ç°æ¶ˆæ¯ä¼ é€’ -
<strong>åˆ†å¸ƒå¼é”</strong>ï¼šåˆ©ç”¨SETNXå‘½ä»¤å®ç°åˆ†å¸ƒå¼é”</p>
<h4 id="æŠ€æœ¯ç‰¹ç‚¹">2.1.3 æŠ€æœ¯ç‰¹ç‚¹</h4>
<p><strong>ä¼˜åŠ¿</strong>ï¼š - æ•°æ®ç»“æ„ä¸°å¯Œï¼Œæ”¯æŒå¤æ‚ä¸šåŠ¡åœºæ™¯ -
æ€§èƒ½ä¼˜ç§€ï¼Œå•æœºå¯å¤„ç†10ä¸‡+ QPS - æ”¯æŒä¸»ä»å¤åˆ¶å’Œé›†ç¾¤æ¨¡å¼ï¼Œé«˜å¯ç”¨ -
æ”¯æŒLuaè„šæœ¬ï¼Œæ”¯æŒå¤æ‚é€»è¾‘ - ç¤¾åŒºæ´»è·ƒï¼Œç”Ÿæ€å®Œå–„</p>
<p><strong>åŠ£åŠ¿</strong>ï¼š - å•çº¿ç¨‹æ¨¡å‹ï¼ŒCPUåˆ©ç”¨ç‡ç›¸å¯¹è¾ƒä½ -
å†…å­˜æˆæœ¬è¾ƒé«˜ï¼Œéœ€è¦è¶³å¤Ÿçš„å†…å­˜èµ„æº - å¤§å¯¹è±¡å­˜å‚¨æ•ˆç‡ä¸å¦‚Memcached</p>
<h3 id="memcached">2.2 Memcached</h3>
<h4 id="æ ¸å¿ƒè®¾è®¡æ€è·¯-1">2.2.1 æ ¸å¿ƒè®¾è®¡æ€è·¯</h4>
<p>Memcachedæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„åˆ†å¸ƒå¼å†…å­˜å¯¹è±¡ç¼“å­˜ç³»ç»Ÿï¼Œå…¶æ ¸å¿ƒè®¾è®¡æ€è·¯åŒ…æ‹¬ï¼š</p>
<p><strong>ç®€å•é”®å€¼å­˜å‚¨</strong>ï¼š - ä»…æ”¯æŒç®€å•çš„é”®å€¼å¯¹å­˜å‚¨ -
ä¸æ”¯æŒå¤æ‚çš„æ•°æ®ç»“æ„ - æ•°æ®æœ€å¤§æ”¯æŒ1MB</p>
<p><strong>å¤šçº¿ç¨‹æ¨¡å‹</strong>ï¼š - é‡‡ç”¨å¤šçº¿ç¨‹å¤„ç†è¯·æ±‚ -
åŸºäºI/Oå¤šè·¯å¤ç”¨æŠ€æœ¯ - ä¸»çº¿ç¨‹æ¥æ”¶è¯·æ±‚åï¼Œåˆ†å‘ç»™å­çº¿ç¨‹å¤„ç†</p>
<p><strong>LRUæ·˜æ±°ç­–ç•¥</strong>ï¼š - é‡‡ç”¨æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆLRUï¼‰ç®—æ³•æ·˜æ±°ç¼“å­˜
- å½“å†…å­˜ä¸è¶³æ—¶ï¼Œè‡ªåŠ¨æ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ® - æ”¯æŒè®¾ç½®è¿‡æœŸæ—¶é—´</p>
<h4 id="é€‚ç”¨åœºæ™¯-1">2.2.2 é€‚ç”¨åœºæ™¯</h4>
<p>Memcachedé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š -
<strong>ç®€å•ç¼“å­˜</strong>ï¼šä»…éœ€å­˜å‚¨ç®€å•çš„é”®å€¼å¯¹æ•°æ® -
<strong>è¯»å¤šå†™å°‘</strong>ï¼šé€‚åˆç¼“å­˜è¯»å–é¢‘ç¹ã€æ›´æ–°è¾ƒå°‘çš„æ•°æ® -
<strong>å¤§å¯¹è±¡ç¼“å­˜</strong>ï¼šå¯¹å¤§å¯¹è±¡çš„å­˜å‚¨æ•ˆç‡è¾ƒé«˜ -
<strong>å·²æœ‰ç³»ç»Ÿ</strong>ï¼šè®¸å¤šè€ç³»ç»Ÿå·²ç»ä½¿ç”¨Memcached</p>
<h4 id="æŠ€æœ¯ç‰¹ç‚¹-1">2.2.3 æŠ€æœ¯ç‰¹ç‚¹</h4>
<p><strong>ä¼˜åŠ¿</strong>ï¼š - ç®€å•æ˜“ç”¨ï¼Œå­¦ä¹ æˆæœ¬ä½ -
å¤šçº¿ç¨‹æ¨¡å‹ï¼ŒCPUåˆ©ç”¨ç‡é«˜ - å¯¹å¤§å¯¹è±¡å­˜å‚¨æ•ˆç‡é«˜ -
å†…å­˜ç®¡ç†ç®€å•ï¼Œä¸æ˜“å†…å­˜æ³„æ¼</p>
<p><strong>åŠ£åŠ¿</strong>ï¼š - æ•°æ®ç»“æ„å•ä¸€ï¼Œä¸æ”¯æŒå¤æ‚ä¸šåŠ¡åœºæ™¯ -
ä¸æ”¯æŒæŒä¹…åŒ–ï¼Œé‡å¯åæ•°æ®ä¸¢å¤± - ä¸æ”¯æŒä¸»ä»å¤åˆ¶å’Œé›†ç¾¤æ¨¡å¼ -
åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œæ‰©å±•æ€§æœ‰é™</p>
<h3 id="åˆ†å¸ƒå¼æ•°æ®åº“ç¼“å­˜">2.3 åˆ†å¸ƒå¼æ•°æ®åº“ç¼“å­˜</h3>
<h4 id="æ ¸å¿ƒè®¾è®¡æ€è·¯-2">2.3.1 æ ¸å¿ƒè®¾è®¡æ€è·¯</h4>
<p>åˆ†å¸ƒå¼æ•°æ®åº“ç¼“å­˜æ˜¯æŒ‡åˆ©ç”¨æ•°æ®åº“è‡ªèº«çš„ç¼“å­˜èƒ½åŠ›æ¥å®ç°åˆ†å¸ƒå¼ç¼“å­˜ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p>
<p><strong>SQL Serverç¼“å­˜</strong>ï¼š - åˆ©ç”¨SQL Serverçš„å†…å­˜ä¼˜åŒ–è¡¨ -
ä½¿ç”¨SQL Serverçš„æŸ¥è¯¢è®¡åˆ’ç¼“å­˜ - åˆ©ç”¨SQL Serverçš„Service
Brokerå®ç°ç¼“å­˜é€šçŸ¥</p>
<p><strong>MongoDBç¼“å­˜</strong>ï¼š - åˆ©ç”¨MongoDBçš„å†…å­˜å­˜å‚¨å¼•æ“ -
åˆ©ç”¨MongoDBçš„TTLç´¢å¼•å®ç°è¿‡æœŸ - åˆ©ç”¨MongoDBçš„Change
Streamå®ç°ç¼“å­˜å¤±æ•ˆ</p>
<h4 id="é€‚ç”¨åœºæ™¯-2">2.3.2 é€‚ç”¨åœºæ™¯</h4>
<p>åˆ†å¸ƒå¼æ•°æ®åº“ç¼“å­˜é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š -
<strong>å·²æœ‰æ•°æ®åº“</strong>ï¼šå·²ç»ä½¿ç”¨åˆ†å¸ƒå¼æ•°æ®åº“çš„ç³»ç»Ÿ -
<strong>æ•°æ®ä¸€è‡´æ€§è¦æ±‚é«˜</strong>ï¼šéœ€è¦ç¼“å­˜å’Œæ•°æ®åº“å¼ºä¸€è‡´æ€§çš„åœºæ™¯ -
<strong>å‡å°‘ç³»ç»Ÿå¤æ‚åº¦</strong>ï¼šä¸æƒ³å¼•å…¥é¢å¤–çš„ç¼“å­˜ç³»ç»Ÿ</p>
<h4 id="æŠ€æœ¯ç‰¹ç‚¹-2">2.3.3 æŠ€æœ¯ç‰¹ç‚¹</h4>
<p><strong>ä¼˜åŠ¿</strong>ï¼š - æ— éœ€é¢å¤–éƒ¨ç½²ç¼“å­˜ç³»ç»Ÿ -
æ•°æ®ä¸€è‡´æ€§å¥½ï¼Œç¼“å­˜å’Œæ•°æ®åº“åŒæ­¥ - å‡å°‘ç³»ç»Ÿå¤æ‚åº¦</p>
<p><strong>åŠ£åŠ¿</strong>ï¼š - æ€§èƒ½ä¸å¦‚ä¸“ç”¨ç¼“å­˜ç³»ç»Ÿ - æ•°æ®åº“è´Ÿè½½å¯èƒ½å¢åŠ  -
åŠŸèƒ½ç›¸å¯¹æœ‰é™</p>
<h3 id="æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“">2.4 æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“</h3>
<table>
<thead>
<tr>
<th>æ–¹æ¡ˆ</th>
<th>æ•°æ®ç»“æ„</th>
<th>æ€§èƒ½</th>
<th>é«˜å¯ç”¨</th>
<th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Redis</strong></td>
<td>ä¸°å¯Œ</td>
<td>ä¼˜ç§€</td>
<td>å¤æ‚ä¸šåŠ¡åœºæ™¯ã€é«˜æ€§èƒ½è¦æ±‚</td>
<td></td>
</tr>
<tr>
<td><strong>Memcached</strong></td>
<td>ç®€å•</td>
<td>è‰¯å¥½</td>
<td>ç®€å•ç¼“å­˜ã€å¤§å¯¹è±¡å­˜å‚¨</td>
<td></td>
</tr>
<tr>
<td><strong>åˆ†å¸ƒå¼æ•°æ®åº“ç¼“å­˜</strong></td>
<td>ä¾èµ–æ•°æ®åº“</td>
<td>ä¸€èˆ¬</td>
<td>å·²æœ‰æ•°æ®åº“ã€ä¸€è‡´æ€§è¦æ±‚é«˜</td>
<td></td>
</tr>
</tbody>
</table>
<h2
id="ä¸‰.netæŠ€æœ¯æ ˆä¸‹åˆ†å¸ƒå¼ç¼“å­˜çš„æœ€ä½³å®è·µ">ä¸‰ã€.NETæŠ€æœ¯æ ˆä¸‹åˆ†å¸ƒå¼ç¼“å­˜çš„æœ€ä½³å®è·µ</h2>
<h3 id="æŠ€æœ¯æ¶æ„è®¾è®¡">3.1 æŠ€æœ¯æ¶æ„è®¾è®¡</h3>
<p>æ ¹æ®Microsoftå®˜æ–¹æ–‡æ¡£ï¼Œ.NET
Coreæä¾›äº†<code>IDistributedCache</code>æ¥å£æ¥å®ç°åˆ†å¸ƒå¼ç¼“å­˜ã€‚è¯¥æ¥å£å®šä¹‰äº†åˆ†å¸ƒå¼ç¼“å­˜çš„åŸºæœ¬æ“ä½œï¼ŒåŒ…æ‹¬è·å–ã€è®¾ç½®ã€åˆ é™¤ã€åˆ·æ–°ç­‰ã€‚</p>
<h4 id="æ¶æ„å±‚æ¬¡">3.1.1 æ¶æ„å±‚æ¬¡</h4>
<p>åœ¨.NETåº”ç”¨ä¸­ï¼Œåˆ†å¸ƒå¼ç¼“å­˜çš„æ¶æ„å±‚æ¬¡å¦‚ä¸‹ï¼š</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨å±‚ï¼ˆControllers/Servicesï¼‰    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   IDistributedCache æ¥å£å±‚      â”‚
â”‚   - GetAsync                   â”‚
â”‚   - SetAsync                   â”‚
â”‚   - RemoveAsync                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Redis å®ç°                    â”‚
â”‚   - StackExchange.Redis         â”‚
â”‚   - Microsoft.Extensions.Caching  â”‚
â”‚     .StackExchangeRedis         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Redis æœåŠ¡å™¨                  â”‚
â”‚   - å•æœºæ¨¡å¼                   â”‚
â”‚   - ä¸»ä»æ¨¡å¼                   â”‚
â”‚   - é›†ç¾¤æ¨¡å¼                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</pre>
<h4 id="æŠ€æœ¯é€‰å‹">3.1.2 æŠ€æœ¯é€‰å‹</h4>
<p>æ ¹æ®Microsoftå®˜æ–¹æ–‡æ¡£ï¼Œ.NET Coreæä¾›äº†å¤šç§Rediså®ç°ï¼š</p>
<p><strong>Microsoft.Extensions.Caching.StackExchangeRedis</strong>ï¼š -
å®˜æ–¹æ¨èçš„Rediså®ç° - åŸºäºStackExchange.Redisåº“ -
æ”¯æŒè¿æ¥æ± ã€é‡è¯•ã€æ•…éšœè½¬ç§» - ä¸ä¾èµ–æ³¨å…¥æ·±åº¦é›†æˆ</p>
<p><strong>StackExchange.Redis</strong>ï¼š - æœ€æµè¡Œçš„Redis .NETå®¢æˆ·ç«¯ -
åŠŸèƒ½ä¸°å¯Œï¼Œæ€§èƒ½ä¼˜ç§€ - æ”¯æŒæ‰€æœ‰Rediså‘½ä»¤ - ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å®Œå–„</p>
<p><strong>CSRedisCore</strong>ï¼š - é«˜æ€§èƒ½çš„Redis .NETå®¢æˆ·ç«¯ - æ”¯æŒRedis
Cluster - æ”¯æŒRedis Sentinel - æ”¯æŒå¼‚æ­¥æ“ä½œ</p>
<p><strong>æ¨èé€‰æ‹©</strong>ï¼šæ ¹æ®Microsoftå®˜æ–¹æ–‡æ¡£ï¼Œæ¨èä½¿ç”¨<code>Microsoft.Extensions.Caching.StackExchangeRedis</code>ï¼Œå› ä¸ºå®ƒæ˜¯å®˜æ–¹æ¨èçš„å®ç°ï¼Œä¸.NET
Coreæ·±åº¦é›†æˆã€‚</p>
<h3 id="æ ¸å¿ƒapiä½¿ç”¨æ–¹æ³•">3.2 æ ¸å¿ƒAPIä½¿ç”¨æ–¹æ³•</h3>
<h4 id="idistributedcacheæ¥å£">3.2.1 IDistributedCacheæ¥å£</h4>
<p><code>IDistributedCache</code>æ¥å£å®šä¹‰äº†ä»¥ä¸‹æ ¸å¿ƒæ–¹æ³•ï¼š</p>
<pre><code class="language-csharp">public interface IDistributedCache
{
    // è·å–ç¼“å­˜å€¼
    byte[] Get(string key);
    Task&lt;byte[]&gt; GetAsync(string key, CancellationToken token = default);
    
    // è®¾ç½®ç¼“å­˜å€¼
    void Set(string key, byte[] value, DistributedCacheEntryOptions options);
    Task SetAsync(string key, byte[] value, DistributedCacheEntryOptions options, 
               CancellationToken token = default);
    
    // åˆ·æ–°ç¼“å­˜è¿‡æœŸæ—¶é—´
    void Refresh(string key);
    Task RefreshAsync(string key, CancellationToken token = default);
    
    // åˆ é™¤ç¼“å­˜å€¼
    void Remove(string key);
    Task RemoveAsync(string key, CancellationToken token = default);
}</pre>
<h4 id="distributedcacheentryoptions">3.2.2
DistributedCacheEntryOptions</h4>
<p><code>DistributedCacheEntryOptions</code>ç±»ç”¨äºé…ç½®ç¼“å­˜é€‰é¡¹ï¼š</p>
<pre><code class="language-csharp">public class DistributedCacheEntryOptions
{
    // ç»å¯¹è¿‡æœŸæ—¶é—´ï¼šç¼“å­˜é¡¹åœ¨æŒ‡å®šæ—¶é—´åè¿‡æœŸ
    DateTimeOffset? AbsoluteExpiration { get; set; }
    
    // ç›¸å¯¹è¿‡æœŸæ—¶é—´ï¼šç¼“å­˜é¡¹åœ¨æŒ‡å®šæ—¶é—´åè¿‡æœŸï¼ˆç›¸å¯¹äºå½“å‰æ—¶é—´ï¼‰
    TimeSpan? AbsoluteExpirationRelativeToNow { get; set; }
    
    // æ»‘åŠ¨è¿‡æœŸæ—¶é—´ï¼šç¼“å­˜é¡¹åœ¨æŒ‡å®šæ—¶é—´å†…æœªè¢«è®¿é—®åˆ™è¿‡æœŸ
    TimeSpan? SlidingExpiration { get; set; }
}</pre>
<h3 id="é…ç½®æ­¥éª¤">3.3 é…ç½®æ­¥éª¤</h3>
<h4 id="å®‰è£…nugetåŒ…">3.3.1 å®‰è£…NuGetåŒ…</h4>
<p>æ ¹æ®Microsoftå®˜æ–¹æ–‡æ¡£ï¼Œé¦–å…ˆéœ€è¦å®‰è£…ä»¥ä¸‹NuGetåŒ…ï¼š</p>
<pre><code class="language-bash"># å®‰è£…Redisåˆ†å¸ƒå¼ç¼“å­˜å®ç°
dotnet add package Microsoft.Extensions.Caching.StackExchangeRedis

# å¦‚æœä½¿ç”¨Azure Redis Cache
dotnet add package Microsoft.Extensions.Caching.StackExchangeRedis</pre>
<h4 id="é…ç½®ä¾èµ–æ³¨å…¥">3.3.2 é…ç½®ä¾èµ–æ³¨å…¥</h4>
<p>åœ¨<code>Program.cs</code>ä¸­é…ç½®Redisåˆ†å¸ƒå¼ç¼“å­˜ï¼š</p>
<pre><code class="language-csharp">using Microsoft.Extensions.Caching.StackExchangeRedis;
using Microsoft.Extensions.Caching.Distributed;

var builder = WebApplication.CreateBuilder(args);

// é…ç½®Redisåˆ†å¸ƒå¼ç¼“å­˜
builder.Services.AddStackExchangeRedisCache(options =&gt;
{
    // Redisè¿æ¥å­—ç¬¦ä¸²
    options.Configuration = &quot;localhost:6379&quot;;
    
    // å®ä¾‹åç§°ï¼ˆå¯é€‰ï¼‰
    options.InstanceName = &quot;MyApp_&quot;;
    
    // é…ç½®é€‰é¡¹ï¼ˆå¯é€‰ï¼‰
    options.ConfigurationOptions = new StackExchange.Redis.ConfigurationOptions
    {
        AbortOnConnectFail = false,
        ConnectRetry = 3,
        ConnectTimeout = 5000,
        SyncTimeout = 5000
    };
});

var app = builder.Build();</pre>
<p><strong>Azure Redis Cacheé…ç½®ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="language-csharp">builder.Services.AddStackExchangeRedisCache(options =&gt;
{
    options.Configuration = &quot;myredis.redis.cache.windows.net:6380,password=...&quot;;
    options.InstanceName = &quot;MyApp_&quot;;
});</pre>
<h4 id="æ³¨å…¥idistributedcache">3.3.3 æ³¨å…¥IDistributedCache</h4>
<p>åœ¨æœåŠ¡æˆ–æ§åˆ¶å™¨ä¸­æ³¨å…¥<code>IDistributedCache</code>ï¼š</p>
<pre><code class="language-csharp">public class ProductService
{
    private readonly IDistributedCache _cache;
    private readonly AppDbContext _dbContext;

    public ProductService(IDistributedCache cache, AppDbContext dbContext)
    {
        _cache = cache;
        _dbContext = dbContext;
    }
}</pre>
<h3 id="ä»£ç å®ç°ç¤ºä¾‹">3.4 ä»£ç å®ç°ç¤ºä¾‹</h3>
<h4 id="åŸºæœ¬ç¼“å­˜æ“ä½œ">3.4.1 åŸºæœ¬ç¼“å­˜æ“ä½œ</h4>
<p><strong>è·å–å’Œè®¾ç½®ç¼“å­˜</strong>ï¼š</p>
<pre><code class="language-csharp">public async Task&lt;Product&gt; GetProductAsync(int productId)
{
    // ç”Ÿæˆç¼“å­˜é”®
    string cacheKey = $&quot;product:{productId}&quot;;
    
    // å°è¯•ä»ç¼“å­˜è·å–
    byte[] cachedData = await _cache.GetAsync(cacheKey);
    
    if (cachedData != null)
    {
        // ç¼“å­˜å‘½ä¸­ï¼Œååºåˆ—åŒ–æ•°æ®
        return JsonSerializer.Deserialize&lt;Product&gt;(cachedData);
    }
    
    // ç¼“å­˜æœªå‘½ä¸­ï¼Œä»æ•°æ®åº“è·å–
    Product product = await _dbContext.Products
        .FirstOrDefaultAsync(p =&gt; p.Id == productId);
    
    if (product != null)
    {
        // å°†æ•°æ®åºåˆ—åŒ–å¹¶å†™å…¥ç¼“å­˜
        byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
        
        var options = new DistributedCacheEntryOptions
        {
            // è®¾ç½®ç»å¯¹è¿‡æœŸæ—¶é—´ï¼š1å°æ—¶åè¿‡æœŸ
            AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1)
        };
        
        await _cache.SetAsync(cacheKey, serializedData, options);
    }
    
    return product;
}</pre>
<p><strong>åˆ é™¤ç¼“å­˜</strong>ï¼š</p>
<pre><code class="language-csharp">public async Task UpdateProductAsync(Product product)
{
    // æ›´æ–°æ•°æ®åº“
    _dbContext.Products.Update(product);
    await _dbContext.SaveChangesAsync();
    
    // åˆ é™¤ç¼“å­˜
    string cacheKey = $&quot;product:{product.Id}&quot;;
    await _cache.RemoveAsync(cacheKey);
}</pre>
<h4 id="å°è£…ç¼“å­˜è¾…åŠ©ç±»">3.4.2 å°è£…ç¼“å­˜è¾…åŠ©ç±»</h4>
<p>ä¸ºäº†ç®€åŒ–ç¼“å­˜æ“ä½œï¼Œå¯ä»¥å°è£…ä¸€ä¸ªç¼“å­˜è¾…åŠ©ç±»ï¼š</p>
<pre><code class="language-csharp">public class CacheHelper
{
    private readonly IDistributedCache _cache;
    private readonly ILogger&lt;CacheHelper&gt; _logger;

    public CacheHelper(IDistributedCache cache, ILogger&lt;CacheHelper&gt; logger)
    {
        _cache = cache;
        _logger = logger;
    }

    public async Task&lt;T&gt; GetOrCreateAsync&lt;T&gt;(
        string key,
        Func&lt;Task&lt;T&gt;&gt; factory,
        TimeSpan? expiration = null)
    {
        // å°è¯•ä»ç¼“å­˜è·å–
        byte[] cachedData = await _cache.GetAsync(key);
        
        if (cachedData != null)
        {
            _logger.LogDebug(&quot;Cache hit for key: {Key}&quot;, key);
            return JsonSerializer.Deserialize&lt;T&gt;(cachedData);
        }
        
        _logger.LogDebug(&quot;Cache miss for key: {Key}&quot;, key);
        
        // ç¼“å­˜æœªå‘½ä¸­ï¼Œè°ƒç”¨å·¥å‚æ–¹æ³•è·å–æ•°æ®
        T value = await factory();
        
        // å°†æ•°æ®å†™å…¥ç¼“å­˜
        byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(value);
        
        var options = new DistributedCacheEntryOptions
        {
            AbsoluteExpirationRelativeToNow = expiration ?? TimeSpan.FromHours(1)
        };
        
        await _cache.SetAsync(key, serializedData, options);
        
        return value;
    }

    public async Task RemoveAsync(string key)
    {
        await _cache.RemoveAsync(key);
        _logger.LogDebug(&quot;Cache removed for key: {Key}&quot;, key);
    }

    public async Task SetAsync&lt;T&gt;(string key, T value, TimeSpan? expiration = null)
    {
        byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(value);
        
        var options = new DistributedCacheEntryOptions
        {
            AbsoluteExpirationRelativeToNow = expiration ?? TimeSpan.FromHours(1)
        };
        
        await _cache.SetAsync(key, serializedData, options);
        _logger.LogDebug(&quot;Cache set for key: {Key}&quot;, key);
    }
}</pre>
<p><strong>ä½¿ç”¨ç¼“å­˜è¾…åŠ©ç±»</strong>ï¼š</p>
<pre><code class="language-csharp">public class ProductService
{
    private readonly CacheHelper _cache;
    private readonly AppDbContext _dbContext;

    public ProductService(CacheHelper cache, AppDbContext dbContext)
    {
        _cache = cache;
        _dbContext = dbContext;
    }

    public async Task&lt;Product&gt; GetProductAsync(int productId)
    {
        string cacheKey = $&quot;product:{productId}&quot;;
        
        return await _cache.GetOrCreateAsync(
            cacheKey,
            async () =&gt; await _dbContext.Products
                .FirstOrDefaultAsync(p =&gt; p.Id == productId),
            TimeSpan.FromHours(1)
        );
    }
}</pre>
<h3 id="ç¼“å­˜ç­–ç•¥è®¾è®¡">3.5 ç¼“å­˜ç­–ç•¥è®¾è®¡</h3>
<h4 id="ç¼“å­˜é”®è®¾è®¡">3.5.1 ç¼“å­˜é”®è®¾è®¡</h4>
<p><strong>ç¼“å­˜é”®å‘½åè§„èŒƒ</strong>ï¼š</p>
<pre><code class="language-csharp">public static class CacheKeys
{
    // äº§å“ç¼“å­˜
    public static string Product(int id) =&gt; $&quot;product:{id}&quot;;
    
    // äº§å“åˆ—è¡¨ç¼“å­˜
    public static string ProductList(string filter) =&gt; $&quot;product:list:{filter}&quot;;
    
    // ç”¨æˆ·ç¼“å­˜
    public static string User(int id) =&gt; $&quot;user:{id}&quot;;
    
    // åˆ†ç±»ç¼“å­˜
    public static string Category(int id) =&gt; $&quot;category:{id}&quot;;
}</pre>
<p><strong>ç¼“å­˜é”®è®¾è®¡åŸåˆ™</strong>ï¼š - ä½¿ç”¨å†’å·åˆ†éš”ä¸åŒå±‚çº§ -
åŒ…å«ä¸šåŠ¡å®ä½“ç±»å‹ - åŒ…å«å”¯ä¸€æ ‡è¯†ç¬¦ - é¿å…ç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼</p>
<h4 id="è¿‡æœŸç­–ç•¥é€‰æ‹©">3.5.2 è¿‡æœŸç­–ç•¥é€‰æ‹©</h4>
<p><strong>ç»å¯¹è¿‡æœŸ</strong>ï¼š - é€‚ç”¨äºæ•°æ®æ›´æ–°é¢‘ç‡è¾ƒä½çš„åœºæ™¯ -
é€‚ç”¨äºæ•°æ®ä¸€è‡´æ€§è¦æ±‚ä¸é«˜çš„åœºæ™¯ - ç¤ºä¾‹ï¼šäº§å“è¯¦æƒ…ã€æ–‡ç« å†…å®¹</p>
<pre><code class="language-csharp">var options = new DistributedCacheEntryOptions
{
    AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1)
};</pre>
<p><strong>æ»‘åŠ¨è¿‡æœŸ</strong>ï¼š - é€‚ç”¨äºçƒ­ç‚¹æ•°æ® -
é€‚ç”¨äºè®¿é—®é¢‘ç‡ä¸å‡è¡¡çš„åœºæ™¯ - ç¤ºä¾‹ï¼šç”¨æˆ·ä¼šè¯ã€è´­ç‰©è½¦</p>
<pre><code class="language-csharp">var options = new DistributedCacheEntryOptions
{
    SlidingExpiration = TimeSpan.FromMinutes(30)
};</pre>
<p><strong>æ··åˆè¿‡æœŸ</strong>ï¼š - ç»“åˆç»å¯¹è¿‡æœŸå’Œæ»‘åŠ¨è¿‡æœŸ -
é€‚ç”¨äºéœ€è¦å…¼é¡¾æ€§èƒ½å’Œä¸€è‡´æ€§çš„åœºæ™¯ - ç¤ºä¾‹ï¼šæ¨èåˆ—è¡¨ã€æœç´¢ç»“æœ</p>
<pre><code class="language-csharp">var options = new DistributedCacheEntryOptions
{
    AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1),
    SlidingExpiration = TimeSpan.FromMinutes(30)
};</pre>
<h4 id="ç¼“å­˜é¢„çƒ­">3.5.3 ç¼“å­˜é¢„çƒ­</h4>
<p>åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶é¢„å…ˆåŠ è½½çƒ­ç‚¹æ•°æ®åˆ°ç¼“å­˜ï¼š</p>
<pre><code class="language-csharp">public class CacheWarmupService : BackgroundService
{
    private readonly IDistributedCache _cache;
    private readonly AppDbContext _dbContext;
    private readonly ILogger&lt;CacheWarmupService&gt; _logger;

    protected override async Task ExecuteAsync(CancellationToken stoppingToken)
    {
        _logger.LogInformation(&quot;Starting cache warmup...&quot;);
        
        // é¢„çƒ­çƒ­ç‚¹äº§å“
        var hotProducts = await _dbContext.Products
            .Where(p =&gt; p.IsHot)
            .ToListAsync(stoppingToken);
        
        foreach (var product in hotProducts)
        {
            string cacheKey = CacheKeys.Product(product.Id);
            byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
            
            var options = new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(2)
            };
            
            await _cache.SetAsync(cacheKey, serializedData, options);
        }
        
        _logger.LogInformation(&quot;Cache warmup completed: {Count} products&quot;, hotProducts.Count);
    }
}</pre>
<h3 id="æ•°æ®ä¸€è‡´æ€§ä¿éšœ">3.6 æ•°æ®ä¸€è‡´æ€§ä¿éšœ</h3>
<h4 id="ç¼“å­˜æ›´æ–°ç­–ç•¥">3.6.1 ç¼“å­˜æ›´æ–°ç­–ç•¥</h4>
<p><strong>Cache-Asideæ¨¡å¼</strong>ï¼ˆæ—è·¯ç¼“å­˜ï¼‰ï¼š</p>
<pre><code class="language-csharp">public async Task&lt;Product&gt; UpdateProductAsync(Product product)
{
    // æ­¥éª¤1ï¼šæ›´æ–°æ•°æ®åº“
    _dbContext.Products.Update(product);
    await _dbContext.SaveChangesAsync();
    
    // æ­¥éª¤2ï¼šåˆ é™¤ç¼“å­˜
    string cacheKey = CacheKeys.Product(product.Id);
    await _cache.RemoveAsync(cacheKey);
    
    // æ­¥éª¤3ï¼šä¸‹æ¬¡è¯»å–æ—¶é‡æ–°åŠ è½½ç¼“å­˜
    return product;
}</pre>
<p><strong>Write-Throughæ¨¡å¼</strong>ï¼ˆå†™ç©¿é€ï¼‰ï¼š</p>
<pre><code class="language-csharp">public async Task&lt;Product&gt; UpdateProductAsync(Product product)
{
    // æ­¥éª¤1ï¼šæ›´æ–°æ•°æ®åº“
    _dbContext.Products.Update(product);
    await _dbContext.SaveChangesAsync();
    
    // æ­¥éª¤2ï¼šæ›´æ–°ç¼“å­˜
    string cacheKey = CacheKeys.Product(product.Id);
    byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
    
    var options = new DistributedCacheEntryOptions
    {
        AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1)
    };
    
    await _cache.SetAsync(cacheKey, serializedData, options);
    
    return product;
}</pre>
<p><strong>Write-Behindæ¨¡å¼</strong>ï¼ˆå†™å›ï¼‰ï¼š</p>
<pre><code class="language-csharp">public class ProductService
{
    private readonly IDistributedCache _cache;
    private readonly AppDbContext _dbContext;
    private readonly Channel&lt;Product&gt; _updateChannel;

    public ProductService(IDistributedCache cache, AppDbContext dbContext)
    {
        _cache = cache;
        _dbContext = dbContext;
        _updateChannel = Channel.CreateUnbounded&lt;Product&gt;();
        
        // å¯åŠ¨åå°ä»»åŠ¡å¤„ç†ç¼“å­˜æ›´æ–°
        _ = Task.Run(ProcessCacheUpdates);
    }

    public async Task UpdateProductAsync(Product product)
    {
        // æ­¥éª¤1ï¼šæ›´æ–°æ•°æ®åº“
        _dbContext.Products.Update(product);
        await _dbContext.SaveChangesAsync();
        
        // æ­¥éª¤2ï¼šå°†æ›´æ–°è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—
        await _updateChannel.Writer.WriteAsync(product);
    }

    private async Task ProcessCacheUpdates()
    {
        await foreach (var product in _updateChannel.Reader.ReadAllAsync())
        {
            // å¼‚æ­¥æ›´æ–°ç¼“å­˜
            string cacheKey = CacheKeys.Product(product.Id);
            byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
            
            var options = new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1)
            };
            
            await _cache.SetAsync(cacheKey, serializedData, options);
        }
    }
}</pre>
<h4 id="ç¼“å­˜å¤±æ•ˆç­–ç•¥">3.6.2 ç¼“å­˜å¤±æ•ˆç­–ç•¥</h4>
<p><strong>ä¸»åŠ¨å¤±æ•ˆ</strong>ï¼š</p>
<pre><code class="language-csharp">public async Task DeleteProductAsync(int productId)
{
    // åˆ é™¤æ•°æ®åº“
    var product = await _dbContext.Products.FindAsync(productId);
    if (product != null)
    {
        _dbContext.Products.Remove(product);
        await _dbContext.SaveChangesAsync();
    }
    
    // åˆ é™¤ç¼“å­˜
    string cacheKey = CacheKeys.Product(productId);
    await _cache.RemoveAsync(cacheKey);
    
    // åˆ é™¤ç›¸å…³ç¼“å­˜ï¼ˆå¦‚äº§å“åˆ—è¡¨ï¼‰
    string listCacheKey = CacheKeys.ProductList(&quot;all&quot;);
    await _cache.RemoveAsync(listCacheKey);
}</pre>
<p><strong>æ‰¹é‡å¤±æ•ˆ</strong>ï¼š</p>
<pre><code class="language-csharp">public async Task UpdateCategoryAsync(Category category)
{
    // æ›´æ–°æ•°æ®åº“
    _dbContext.Categories.Update(category);
    await _dbContext.SaveChangesAsync();
    
    // æ‰¹é‡åˆ é™¤ç›¸å…³ç¼“å­˜
    var tasks = new List&lt;Task&gt;();
    
    // åˆ é™¤åˆ†ç±»è¯¦æƒ…ç¼“å­˜
    tasks.Add(_cache.RemoveAsync(CacheKeys.Category(category.Id)));
    
    // åˆ é™¤åˆ†ç±»ä¸‹çš„äº§å“åˆ—è¡¨ç¼“å­˜
    tasks.Add(_cache.RemoveAsync(CacheKeys.ProductList($&quot;category:{category.Id}&quot;)));
    
    await Task.WhenAll(tasks);
}</pre>
<h3 id="ç¼“å­˜ç©¿é€å‡»ç©¿é›ªå´©é˜²æŠ¤">3.7 ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©é˜²æŠ¤</h3>
<h4 id="ç¼“å­˜ç©¿é€é˜²æŠ¤">3.7.1 ç¼“å­˜ç©¿é€é˜²æŠ¤</h4>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šå¤§é‡è¯·æ±‚æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå¯¼è‡´æ¯æ¬¡è¯·æ±‚éƒ½ç»•è¿‡ç¼“å­˜ç›´æ¥æ‰“åˆ°æ•°æ®åº“ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ1ï¼šç©ºå€¼ç¼“å­˜</strong></p>
<pre><code class="language-csharp">public async Task&lt;Product&gt; GetProductAsync(int productId)
{
    string cacheKey = CacheKeys.Product(productId);
    
    // å°è¯•ä»ç¼“å­˜è·å–
    byte[] cachedData = await _cache.GetAsync(cacheKey);
    
    if (cachedData != null)
    {
        // æ£€æŸ¥æ˜¯å¦ä¸ºç©ºå€¼æ ‡è®°
        if (cachedData.Length == 0)
        {
            return null; // è¿”å›ç©ºå€¼
        }
        
        return JsonSerializer.Deserialize&lt;Product&gt;(cachedData);
    }
    
    // ä»æ•°æ®åº“è·å–
    Product product = await _dbContext.Products
        .FirstOrDefaultAsync(p =&gt; p.Id == productId);
    
    if (product == null)
    {
        // ç¼“å­˜ç©ºå€¼ï¼Œè®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´
        await _cache.SetAsync(cacheKey, Array.Empty&lt;byte&gt;(), 
            new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(5)
            });
    }
    else
    {
        // ç¼“å­˜å®é™…æ•°æ®
        byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
        await _cache.SetAsync(cacheKey, serializedData, 
            new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1)
            });
    }
    
    return product;
}</pre>
<p><strong>è§£å†³æ–¹æ¡ˆ2ï¼šå¸ƒéš†è¿‡æ»¤å™¨</strong></p>
<pre><code class="language-csharp">public class BloomFilterCache
{
    private readonly IDistributedCache _cache;
    private readonly IBloomFilter _bloomFilter;

    public async Task&lt;Product&gt; GetProductAsync(int productId)
    {
        string cacheKey = CacheKeys.Product(productId);
        
        // æ­¥éª¤1ï¼šæ£€æŸ¥å¸ƒéš†è¿‡æ»¤å™¨
        if (!_bloomFilter.Contains(productId))
        {
            // å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­æ•°æ®ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›null
            return null;
        }
        
        // æ­¥éª¤2ï¼šå°è¯•ä»ç¼“å­˜è·å–
        byte[] cachedData = await _cache.GetAsync(cacheKey);
        if (cachedData != null)
        {
            return JsonSerializer.Deserialize&lt;Product&gt;(cachedData);
        }
        
        // æ­¥éª¤3ï¼šä»æ•°æ®åº“è·å–
        Product product = await _dbContext.Products
            .FirstOrDefaultAsync(p =&gt; p.Id == productId);
        
        if (product != null)
        {
            // æ·»åŠ åˆ°å¸ƒéš†è¿‡æ»¤å™¨
            _bloomFilter.Add(productId);
            
            // ç¼“å­˜æ•°æ®
            byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
            await _cache.SetAsync(cacheKey, serializedData);
        }
        
        return product;
    }
}</pre>
<h4 id="ç¼“å­˜å‡»ç©¿é˜²æŠ¤">3.7.2 ç¼“å­˜å‡»ç©¿é˜²æŠ¤</h4>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šæŸä¸ªçƒ­ç‚¹ç¼“å­˜è¿‡æœŸæ—¶ï¼Œå¤§é‡è¯·æ±‚åŒæ—¶ç©¿é€åˆ°æ•°æ®åº“ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šäº’æ–¥é”</strong></p>
<pre><code class="language-csharp">public class ProductService
{
    private readonly IDistributedCache _cache;
    private readonly IConnectionMultiplexer _redis;
    private readonly AppDbContext _dbContext;

    public async Task&lt;Product&gt; GetProductAsync(int productId)
    {
        string cacheKey = CacheKeys.Product(productId);
        string lockKey = $&quot;lock:{cacheKey}&quot;;
        
        // å°è¯•ä»ç¼“å­˜è·å–
        byte[] cachedData = await _cache.GetAsync(cacheKey);
        if (cachedData != null)
        {
            return JsonSerializer.Deserialize&lt;Product&gt;(cachedData);
        }
        
        // è·å–åˆ†å¸ƒå¼é”
        var db = _redis.GetDatabase();
        bool lockAcquired = await db.StringSetAsync(lockKey, &quot;1&quot;, 
            TimeSpan.FromSeconds(10), 
            When.NotExists);
        
        if (lockAcquired)
        {
            try
            {
                // åŒé‡æ£€æŸ¥ï¼šå¯èƒ½åœ¨ç­‰å¾…æœŸé—´å…¶ä»–è¯·æ±‚å·²ç»å¡«å……äº†ç¼“å­˜
                cachedData = await _cache.GetAsync(cacheKey);
                if (cachedData != null)
                {
                    return JsonSerializer.Deserialize&lt;Product&gt;(cachedData);
                }
                
                // ä»æ•°æ®åº“è·å–æ•°æ®
                Product product = await _dbContext.Products
                    .FirstOrDefaultAsync(p =&gt; p.Id == productId);
                
                if (product != null)
                {
                    // ç¼“å­˜æ•°æ®
                    byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
                    await _cache.SetAsync(cacheKey, serializedData, 
                        new DistributedCacheEntryOptions
                        {
                            AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1)
                        });
                }
                
                return product;
            }
            finally
            {
                // é‡Šæ”¾é”
                await db.KeyDeleteAsync(lockKey);
            }
        }
        else
        {
            // ç­‰å¾…é”é‡Šæ”¾åé‡æ–°è·å–ç¼“å­˜
            await Task.Delay(100);
            return await GetProductAsync(productId);
        }
    }
}</pre>
<h4 id="ç¼“å­˜é›ªå´©é˜²æŠ¤">3.7.3 ç¼“å­˜é›ªå´©é˜²æŠ¤</h4>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šå¤§é‡ç¼“å­˜åŒæ—¶è¿‡æœŸï¼Œå¯¼è‡´æ‰€æœ‰è¯·æ±‚éƒ½ç©¿é€åˆ°æ•°æ®åº“ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ1ï¼šéšæœºè¿‡æœŸæ—¶é—´</strong></p>
<pre><code class="language-csharp">public async Task&lt;Product&gt; GetProductAsync(int productId)
{
    string cacheKey = CacheKeys.Product(productId);
    
    // å°è¯•ä»ç¼“å­˜è·å–
    byte[] cachedData = await _cache.GetAsync(cacheKey);
    if (cachedData != null)
    {
        return JsonSerializer.Deserialize&lt;Product&gt;(cachedData);
    }
    
    // ä»æ•°æ®åº“è·å–æ•°æ®
    Product product = await _dbContext.Products
        .FirstOrDefaultAsync(p =&gt; p.Id == productId);
    
    if (product != null)
    {
        // åœ¨åŸºç¡€è¿‡æœŸæ—¶é—´ä¸Šå¢åŠ éšæœºåç§»é‡
        var baseExpiration = TimeSpan.FromHours(1);
        var randomOffset = TimeSpan.FromSeconds(Random.Shared.Next(0, 300)); // 0-5åˆ†é’Ÿéšæœºåç§»
        
        byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
        await _cache.SetAsync(cacheKey, serializedData, 
            new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = baseExpiration + randomOffset
            });
    }
    
    return product;
}</pre>
<p><strong>è§£å†³æ–¹æ¡ˆ2ï¼šå¤šçº§ç¼“å­˜</strong></p>
<p>ç»“åˆæœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜ï¼š</p>
<pre><code class="language-csharp">public class ProductService
{
    private readonly IDistributedCache _distributedCache;
    private readonly IMemoryCache _memoryCache;
    private readonly AppDbContext _dbContext;

    public async Task&lt;Product&gt; GetProductAsync(int productId)
    {
        string cacheKey = CacheKeys.Product(productId);
        
        // æ­¥éª¤1ï¼šæ£€æŸ¥æœ¬åœ°ç¼“å­˜
        if (_memoryCache.TryGetValue(cacheKey, out Product product))
        {
            return product;
        }
        
        // æ­¥éª¤2ï¼šæ£€æŸ¥åˆ†å¸ƒå¼ç¼“å­˜
        byte[] cachedData = await _distributedCache.GetAsync(cacheKey);
        if (cachedData != null)
        {
            product = JsonSerializer.Deserialize&lt;Product&gt;(cachedData);
            
            // å›å¡«åˆ°æœ¬åœ°ç¼“å­˜
            _memoryCache.Set(cacheKey, product, 
                new MemoryCacheEntryOptions
                {
                    AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(10)
                });
            
            return product;
        }
        
        // æ­¥éª¤3ï¼šä»æ•°æ®åº“è·å–
        product = await _dbContext.Products
            .FirstOrDefaultAsync(p =&gt; p.Id == productId);
        
        if (product != null)
        {
            // åŒæ—¶å†™å…¥ä¸¤çº§ç¼“å­˜
            byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
            
            await _distributedCache.SetAsync(cacheKey, serializedData, 
                new DistributedCacheEntryOptions
                {
                    AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1)
                });
            
            _memoryCache.Set(cacheKey, product, 
                new MemoryCacheEntryOptions
                {
                    AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(10)
                });
        }
        
        return product;
    }
}</pre>
<h3 id="æ€§èƒ½ä¼˜åŒ–">3.8 æ€§èƒ½ä¼˜åŒ–</h3>
<h4 id="æ‰¹é‡æ“ä½œ">3.8.1 æ‰¹é‡æ“ä½œ</h4>
<pre><code class="language-csharp">public async Task&lt;Dictionary&lt;int, Product&gt;&gt; GetProductsAsync(IEnumerable&lt;int&gt; productIds)
{
    var tasks = productIds.Select(async id =&gt;
    {
        string cacheKey = CacheKeys.Product(id);
        byte[] cachedData = await _cache.GetAsync(cacheKey);
        
        if (cachedData != null)
        {
            return (id, JsonSerializer.Deserialize&lt;Product&gt;(cachedData));
        }
        
        // ä»æ•°æ®åº“è·å–
        Product product = await _dbContext.Products
            .FirstOrDefaultAsync(p =&gt; p.Id == id);
        
        if (product != null)
        {
            byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(product);
            await _cache.SetAsync(cacheKey, serializedData, 
                new DistributedCacheEntryOptions
                {
                    AbsoluteExpirationRelativeToNow = TimeSpan.FromHours(1)
                });
        }
        
        return (id, product);
    });
    
    var results = await Task.WhenAll(tasks);
    return results.ToDictionary(r =&gt; r.id, r =&gt; r.Item2);
}</pre>
<h4 id="åºåˆ—åŒ–ä¼˜åŒ–">3.8.2 åºåˆ—åŒ–ä¼˜åŒ–</h4>
<p>ä½¿ç”¨é«˜æ€§èƒ½åºåˆ—åŒ–å™¨ï¼š</p>
<pre><code class="language-csharp">public class ProductSerializer
{
    public static byte[] Serialize(Product product)
    {
        // ä½¿ç”¨MemoryPackç­‰é«˜æ€§èƒ½åºåˆ—åŒ–å™¨
        return MemoryPackSerializer.Serialize(product);
    }
    
    public static Product Deserialize(byte[] data)
    {
        return MemoryPackSerializer.Deserialize&lt;Product&gt;(data);
    }
}

public async Task&lt;Product&gt; GetProductAsync(int productId)
{
    string cacheKey = CacheKeys.Product(productId);
    
    byte[] cachedData = await _cache.GetAsync(cacheKey);
    if (cachedData != null)
    {
        return ProductSerializer.Deserialize(cachedData);
    }
    
    Product product = await _dbContext.Products
        .FirstOrDefaultAsync(p =&gt; p.Id == productId);
    
    if (product != null)
    {
        byte[] serializedData = ProductSerializer.Serialize(product);
        await _cache.SetAsync(cacheKey, serializedData);
    }
    
    return product;
}</pre>
<h4 id="è¿æ¥æ± ä¼˜åŒ–">3.8.3 è¿æ¥æ± ä¼˜åŒ–</h4>
<pre><code class="language-csharp">builder.Services.AddStackExchangeRedisCache(options =&gt;
{
    options.Configuration = &quot;localhost:6379&quot;;
    options.InstanceName = &quot;MyApp_&quot;;
    
    options.ConfigurationOptions = new StackExchange.Redis.ConfigurationOptions
    {
        // è¿æ¥è¶…æ—¶
        ConnectTimeout = 5000,
        
        // åŒæ­¥è¶…æ—¶
        SyncTimeout = 5000,
        
        // è¿æ¥é‡è¯•æ¬¡æ•°
        ConnectRetry = 3,
        
        // è¿æ¥å¤±è´¥æ—¶æ˜¯å¦ä¸­æ­¢
        AbortOnConnectFail = false,
        
        // è¿æ¥æ± é…ç½®
        EndPoints = { &quot;localhost:6379&quot; },
        DefaultDatabase = 0,
        Password = &quot;&quot;,
        Ssl = false,
        
        // è¿æ¥æ± å¤§å°
        MaxDirectMultiplexConnections = 100,
        KeepAlive = 180,
        ConnectRetry = 3,
        ReconnectRetryPolicy = new ExponentialRetry(5000)
    };
});</pre>
<h3 id="ç›‘æ§å’Œæ—¥å¿—">3.9 ç›‘æ§å’Œæ—¥å¿—</h3>
<h4 id="ç¼“å­˜å‘½ä¸­ç‡ç›‘æ§">3.9.1 ç¼“å­˜å‘½ä¸­ç‡ç›‘æ§</h4>
<pre><code class="language-csharp">public class CacheMonitor
{
    private readonly IDistributedCache _cache;
    private readonly ILogger&lt;CacheMonitor&gt; _logger;
    private long _cacheHits;
    private long _cacheMisses;

    public double HitRate =&gt; _cacheHits / (double)(_cacheHits + _cacheMisses);

    public async Task&lt;T&gt; GetOrCreateAsync&lt;T&gt;(
        string key,
        Func&lt;Task&lt;T&gt;&gt; factory,
        TimeSpan? expiration = null)
    {
        byte[] cachedData = await _cache.GetAsync(key);
        
        if (cachedData != null)
        {
            Interlocked.Increment(ref _cacheHits);
            _logger.LogDebug(&quot;Cache hit for key: {Key}&quot;, key);
            return JsonSerializer.Deserialize&lt;T&gt;(cachedData);
        }
        
        Interlocked.Increment(ref _cacheMisses);
        _logger.LogDebug(&quot;Cache miss for key: {Key}&quot;, key);
        
        T value = await factory();
        
        byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(value);
        await _cache.SetAsync(key, serializedData, 
            new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = expiration ?? TimeSpan.FromHours(1)
            });
        
        return value;
    }

    public void LogStatistics()
    {
        _logger.LogInformation(
            &quot;Cache statistics - Hits: {Hits}, Misses: {Misses}, Hit Rate: {HitRate:P2}&quot;,
            _cacheHits, _cacheMisses, HitRate);
    }
}</pre>
<h4 id="æ€§èƒ½ç›‘æ§">3.9.2 æ€§èƒ½ç›‘æ§</h4>
<pre><code class="language-csharp">public class CachePerformanceMonitor
{
    private readonly IDistributedCache _cache;
    private readonly ILogger&lt;CachePerformanceMonitor&gt; _logger;

    public async Task&lt;T&gt; GetOrCreateAsync&lt;T&gt;(
        string key,
        Func&lt;Task&lt;T&gt;&gt; factory,
        TimeSpan? expiration = null)
    {
        var stopwatch = Stopwatch.StartNew();
        
        byte[] cachedData = await _cache.GetAsync(key);
        
        if (cachedData != null)
        {
            stopwatch.Stop();
            _logger.LogDebug(
                &quot;Cache hit for key: {Key}, Latency: {Latency}ms&quot;,
                key, stopwatch.ElapsedMilliseconds);
            
            return JsonSerializer.Deserialize&lt;T&gt;(cachedData);
        }
        
        stopwatch.Restart();
        T value = await factory();
        stopwatch.Stop();
        
        _logger.LogDebug(
            &quot;Cache miss for key: {Key}, DB Query Latency: {Latency}ms&quot;,
            key, stopwatch.ElapsedMilliseconds);
        
        stopwatch.Restart();
        byte[] serializedData = JsonSerializer.SerializeToUtf8Bytes(value);
        await _cache.SetAsync(key, serializedData, 
            new DistributedCacheEntryOptions
            {
                AbsoluteExpirationRelativeToNow = expiration ?? TimeSpan.FromHours(1)
            });
        stopwatch.Stop();
        
        _logger.LogDebug(
            &quot;Cache set for key: {Key}, Write Latency: {Latency}ms&quot;,
            key, stopwatch.ElapsedMilliseconds);
        
        return value;
    }
}</pre>
<h2 id="å››æ€»ç»“">å››ã€æ€»ç»“</h2>
<p>Redisä½œä¸ºä¸šç•Œé¢†å…ˆçš„åˆ†å¸ƒå¼ç¼“å­˜è§£å†³æ–¹æ¡ˆï¼Œåœ¨.NETæŠ€æœ¯æ ˆä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ã€‚é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼š</p>
<h3 id="åˆ†å¸ƒå¼ç¼“å­˜çš„æ ¸å¿ƒä»·å€¼">4.1 åˆ†å¸ƒå¼ç¼“å­˜çš„æ ¸å¿ƒä»·å€¼</h3>
<ol type="1">
<li><strong>è§£å†³æ•°æ®åº“è´Ÿè½½é—®é¢˜</strong>ï¼šé€šè¿‡ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼Œå¤§å¹…å‡å°‘æ•°æ®åº“æŸ¥è¯¢</li>
<li><strong>æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦</strong>ï¼šå†…å­˜è®¿é—®æ¯”æ•°æ®åº“è®¿é—®å¿«å‡ ä¸ªæ•°é‡çº§</li>
<li><strong>ä¿è¯æ•°æ®ä¸€è‡´æ€§</strong>ï¼šè·¨æœåŠ¡å™¨å…±äº«ç¼“å­˜æ•°æ®ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´</li>
<li><strong>æå‡ç³»ç»Ÿå¯æ‰©å±•æ€§</strong>ï¼šæ”¯æŒæ°´å¹³æ‰©å±•ï¼Œåº”å¯¹é«˜å¹¶å‘åœºæ™¯</li>
</ol>
<h3 id="netæŠ€æœ¯æ ˆçš„æœ€ä½³å®è·µ">4.2 .NETæŠ€æœ¯æ ˆçš„æœ€ä½³å®è·µ</h3>
<ol type="1">
<li><strong>ä½¿ç”¨å®˜æ–¹æ¨èæ–¹æ¡ˆ</strong>ï¼šé‡‡ç”¨<code>Microsoft.Extensions.Caching.StackExchangeRedis</code></li>
<li><strong>åˆç†è®¾è®¡ç¼“å­˜ç­–ç•¥</strong>ï¼šæ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„è¿‡æœŸç­–ç•¥</li>
<li><strong>é˜²æŠ¤ç¼“å­˜é—®é¢˜</strong>ï¼šå®ç°ç©¿é€ã€å‡»ç©¿ã€é›ªå´©çš„é˜²æŠ¤æœºåˆ¶</li>
<li><strong>ä¼˜åŒ–æ€§èƒ½</strong>ï¼šä½¿ç”¨æ‰¹é‡æ“ä½œã€é«˜æ€§èƒ½åºåˆ—åŒ–å™¨ã€è¿æ¥æ± ä¼˜åŒ–</li>
<li><strong>ç›‘æ§å’Œæ—¥å¿—</strong>ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§ä½“ç³»ï¼ŒæŒç»­ä¼˜åŒ–ç¼“å­˜æ•ˆæœ</li>
</ol>
<h3 id="å®æ–½å»ºè®®">4.3 å®æ–½å»ºè®®</h3>
<ol type="1">
<li><strong>æ¸è¿›å¼å®æ–½</strong>ï¼šä»æ ¸å¿ƒåŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥æ‰©å±•åˆ°å…¨ç³»ç»Ÿ</li>
<li><strong>å……åˆ†æµ‹è¯•</strong>ï¼šåœ¨æµ‹è¯•ç¯å¢ƒå……åˆ†éªŒè¯ç¼“å­˜ç­–ç•¥å’Œæ€§èƒ½</li>
<li><strong>æŒç»­ä¼˜åŒ–</strong>ï¼šæ ¹æ®ç›‘æ§æ•°æ®æŒç»­ä¼˜åŒ–ç¼“å­˜é…ç½®</li>
<li><strong>æ–‡æ¡£å®Œå–„</strong>ï¼šå»ºç«‹å®Œå–„çš„ç¼“å­˜ä½¿ç”¨æ–‡æ¡£å’Œè§„èŒƒ</li>
</ol>
<p>é€šè¿‡åˆç†ä½¿ç”¨Redisåˆ†å¸ƒå¼ç¼“å­˜ï¼Œå¯ä»¥æ˜¾è‘—æå‡.NETåº”ç”¨çš„æ€§èƒ½å’Œå¯é æ€§ï¼Œä¸ºç³»ç»Ÿçš„ç¨³å®šè¿è¡Œæä¾›æœ‰åŠ›ä¿éšœã€‚</p>
<h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2>
<h3 id="microsoftå®˜æ–¹æ–‡æ¡£">Microsoftå®˜æ–¹æ–‡æ¡£</h3>
<ul>
<li><a
href="https://learn.microsoft.com/zh-cn/aspnet/core/performance/caching/overview?view=aspnetcore-9.0">ASP.NET
Core ä¸­çš„ç¼“å­˜æ¦‚è¿°</a></li>
<li><a
href="https://learn.microsoft.com/zh-cn/azure/redis/dotnet-how-to-use-azure-redis-cache">å¿«é€Ÿå…¥é—¨:åœ¨
.NET Framework ä¸­ä½¿ç”¨ Azure Redis ç¼“å­˜</a></li>
<li><a
href="https://learn.microsoft.com/zh-cn/azure/architecture/web-apps/guides/enterprise-app-patterns/reliable-web-app/dotnet/guidance">é€‚ç”¨äº
.NET çš„å¯é  Web åº”ç”¨æ¨¡å¼</a></li>
<li><a
href="https://learn.microsoft.com/zh-cn/dotnet/aspire/caching/caching-integrations">ä½¿ç”¨
Aspire é›†æˆå®ç°ç¼“å­˜</a></li>
<li><a
href="https://learn.microsoft.com/zh-cn/dotnet/aspire/caching/stackexchange-redis-integration">Aspire
Redis é›†æˆ</a></li>
</ul>
<h3 id="rediså®˜æ–¹æ–‡æ¡£">Rediså®˜æ–¹æ–‡æ¡£</h3>
<ul>
<li><a href="https://redis.io/">Rediså®˜æ–¹ç½‘ç«™</a></li>
<li><a href="https://redis.io/commands">Rediså‘½ä»¤å‚è€ƒ</a></li>
<li><a href="https://redis.io/topics/data-types">Redisæ•°æ®ç±»å‹</a></li>
</ul>
<h3 id="æŠ€æœ¯åšå®¢å’Œæ–‡ç« ">æŠ€æœ¯åšå®¢å’Œæ–‡ç« </h3>
<ul>
<li><a
href="https://blog.csdn.net/Z123C456H/article/details/151070058">Redisç¼“å­˜ä¸‰å…„å¼Ÿ:ç©¿é€ã€å‡»ç©¿ã€é›ªå´©</a></li>
<li><a
href="https://blog.csdn.net/qq_37515544/article/details/152307289">äº¿çº§æµé‡ç³»ç»ŸRedisç¼“å­˜æ¶æ„:é˜²å¾¡ç¼“å­˜å‡»ç©¿ã€é›ªå´©ä¸ç©¿é€çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ</a></li>
<li><a
href="http://m.toutiao.com/group/7585848764624978458">ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©</a></li>
</ul>
<h3 id="æŠ€æœ¯å¯¹æ¯”æ–‡ç« ">æŠ€æœ¯å¯¹æ¯”æ–‡ç« </h3>
<ul>
<li><a
href="https://www.cnblogs.com/mark-chen/articles/18633554">åˆ†å¸ƒå¼ç¼“å­˜
Rediså’ŒMemcachedçš„åŒºåˆ«</a></li>
<li><a
href="http://m.toutiao.com/group/7413942422998221362/">Rediså’ŒMemcachedåŒºåˆ«è¯¦è§£(5å¤§æ ¸å¿ƒåŒºåˆ«)</a></li>
<li><a
href="https://blog.csdn.net/2501_91246186/article/details/146540986">åˆ†å¸ƒå¼ç¼“å­˜ç³»ç»Ÿ
Redis vs Memcached æ€§èƒ½å¯¹æ¯”</a></li>
</ul>

                </article>
            </div>
        </section>

        <!-- å³ä¾§çƒ­é—¨æ–‡ç«  -->
        <aside class="popular-sidebar">
            <div class="popular-header">
                <h3>çƒ­é—¨æ–‡ç« </h3>
            </div>
            <div class="popular-list" id="popular-list">
                <!-- åŠ¨æ€ç”Ÿæˆçš„çƒ­é—¨æ–‡ç« åˆ—è¡¨ -->
            </div>
        </aside>
    </main>

    <!-- JavaScript -->
    <script type="module" src="/script.js?v=2.2.0"></script>
    
    <!-- Initialize Highlight.js -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Highlight all code blocks
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        });
    </script>
</body>
</html>